import{pathExists,outputJSON,outputFile}from"fs-extra";import chalk from"chalk";function __awaiter(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})}function __generator(a,b){var e={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]},h,i,j,k;return k={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k;function c(a){return function(b){return d([a,b])}}function d(c){if(h)throw new TypeError("Generator is already executing.");while(e)try{if(h=1,i&&(j=2&c[0]?i["return"]:c[0]?i["throw"]||((j=i["return"])&&j.call(i),0):i.next)&&!(j=j.call(i,c[1])).done)return j;if(i=0,j)c=[2&c[0],j.value];switch(c[0]){case 0:case 1:j=c;break;case 4:e.label++;return{value:c[1],done:!1};case 5:e.label++;i=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(j=e.trys,j=0<j.length&&j[j.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!j||c[1]>j[0]&&c[1]<j[3])){e.label=c[1];break}if(6===c[0]&&e.label<j[1]){e.label=j[1];j=c;break}if(j&&e.label<j[2]){e.label=j[2];e.ops.push(c);break}if(j[2])e.ops.pop();e.trys.pop();continue;}c=b.call(a,e)}catch(a){c=[6,a];i=0}finally{h=j=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var log=console.info,errorMsg=chalk.bold.red,warnMsg=chalk.bold.keyword("orange"),createMsg=chalk.bold.green,updateMsg=chalk.bold.blue,lightMsg=chalk.bold.magenta,outputContent=function(a,b,c){if("object"==typeof b){return outputJSON(a,b,{spaces:2}).then(function(){return log(c)}).catch(function(a){return console.error(errorMsg(a))})}else{return outputFile(a,b).then(function(){return log(c)}).catch(function(a){return console.error(errorMsg(a))})}},genFile=function(a){var b=a.filename,c=a.template,d=a.path,e=void 0===d?"":d,f=a.update,g=e.replace(/(^\/)|(\/$)/g,"");g=g?g+"/"+b:b;return new Promise(function(a){pathExists(g,function(b,d){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:if(!!d)return[3,2];return[4,outputContent(g,c,createMsg("[create]")+": "+lightMsg(g))];case 1:b.sent();a("create");return[3,5];case 2:if(!f)return[3,4];return[4,outputContent(g,c,updateMsg("[update]")+": "+lightMsg(g))];case 3:b.sent();a("update");return[3,5];case 4:log(warnMsg("[exist]")+": "+lightMsg(g));a("exist");b.label=5;case 5:return[2];}})})})})};export default genFile;
